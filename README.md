# Drive Constructor

An open source educational tool for electrical engineers.

## Before you start

If you want to contribute to the project, you also need to be familiar with
[GitHub](https://docs.github.com/en/get-started) flows, and install essential
software development tools:

- The [git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)
  source version control system
- A text editor of your choice, for example,
  [Visual Studio Code](https://code.visualstudio.com/)

You can also install
[GitHub Command Line Interface (CLI)](https://github.com/cli/cli#installation),
it is quite useful.

Make sure you have a GitHub account and your local `git` installation is
configured to use it. For more information follow GitHub
[documentation](https://docs.github.com/en/get-started/git-basics/set-up-git).

Make sure you know how to run operating system commands in a terminal or a
command prompt window. This will the main interface between you and the
development environment.

## Installation

Make a copy of the GitHub repository on your local computer. Here is an example
using GitHub CLI:

    > gh repo clone driveconstructor/driveconstructor

`DriveConstructor` is built using [Next.JS](https://nextjs.org/) web development
framework.

You need to install the latest long term support version (LTS) of
[Node.js](https://nodejs.org/en). It is available for Linux, macOS and Windows.

Then you need to install Node packages required by the application by running
the following command in the terminal:

    > npm install

If you want to run end-to-end tests you will also need to install
[playwright](https://playwright.dev/) dependencies:

    > npx playwright install

Note: every time there are changes in `package.json`, you need to run the
installation commands again.

## Usage

Run the following command to start the application in the development mode:

    > npm run dev

You can navigate to the output URL to work with the application. When you make
changes in the code, the application in the browser will be automatically
updated.

Run the following command to build the application for production use:

    > npm run build

The build generates a static website in the `out` directory.

Then you can execute the following command to perform end-to-end tests on the
pre-built application:

    > npm run test:e2e

The tests are run in a headless browser.

## Development

All the source code files must follow the [prettier](https://prettier.io/) code
style. You run the following command to perform automatic formatting of all
files.

    > npm run format

If you are using [Visual Studio Code](https://code.visualstudio.com/), you can
install the prettier
[extension](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)
and perform formatting while you editing.

## Writing documentation

`DriveConstructor`is using [Fumadocs](https://fumadocs.dev/) documentation
autoing tool. Get yourself familiar with how to write the documentation using
this framework.

The content files are located in the`content/docs` directory, they are stored
the [MDX](https://mdxjs.com/) markdown format.

If you are using [Visual Studio Code](https://code.visualstudio.com/), you can
install the MDX
[extension](https://marketplace.visualstudio.com/items?itemName=unifiedjs.vscode-mdx)
to unable syntax highlighting.

## Deployment

The website generated by the build command is automatically deployed to GitHub
pages. The application is served from the root directory.

The GitHub action [workflow](.github/workflows/main.yaml) running on merge to
the `main` branch pushes the content of the `out` directory to a staging
repository.

The staging repository location is set in the `STAGING_REPO`
[environment variable](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/store-information-in-variables)
for your code repository. If this variable is not set, the GitHub action
workflow deployment job is skipped.

The deployment job uses a GitHub's personal user access token to push contents
of the `out` directory to the main branch of the staging repository. The token
is set in the`GH_PAT` repository secret variable, and it must have
[content permission](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/controlling-permissions-for-github_token)
for the target staging repository

## Reference implementation

The reference implementation for
[drivconstructor/drivconstructor](https://github.com/driveconstructor/driveconstructor)
repository is deployed to the following domains:

|            |                                             |
| ---------- | ------------------------------------------- |
| staging    | https://driveconstructor-staging.github.io/ |
| production | https://driveconstructor.github.io/         |

## License

See the [LICENSE](LICENSE) file for license rights and limitations (Apache 2.0).
